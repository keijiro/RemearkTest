<!DOCTYPE html>
<html>
  <head>
    <title>21 Material Variants</title>
    <meta charset="utf-8">
    <style>
      .remark-slide-content {
        color: white;
        background-color: black;
        font-size: 32pt;
        padding: 0px 0.5em;
      }
      .remark-code-line { font-size: 16pt; margin: 0.2em 0px; }
      p { margin: 0.5em 0px; line-height: 120%; }
      code { margin: 0px 2em; }
    </style>
  </head>
  <body>
<textarea id="source">

みなさんこんにちは。

今回のトピックは、Unity の新機能、マテリアル・バリアントです。

---

マテリアル・バリアントは Unity 2022.1 で追加された新機能です。

簡単に言うと、あるマテリアルの設定を引き継いで、それとは部分的に異なる設定を持つバリエーションを作るための機能です。

---

> Switch to Desktop

実際に使ってみた方が分かりやすいので、Editor 上で試してみましょう。

今、この３体の石像には同じマテリアルが設定されています。

普通の石みたいな見た目のマテリアルですね。

この Statue という名前のマテリアルです。

---

これのバリアントを作成するには、右クリックして、Create の Material Variant を選びます。

これで Statue をベースとした Statue 2 というバリエーションができました。

これを左側の石像にセットしましょう。

---

この Statue 2 をちょっといじくってみましょうか。

テクスチャを、この汚れた感じのやつに入れ替えてみます。

こうしてバリアント側のプロパティを変更すると、こうやって強調表示されます。

この辺りの仕様はプレハブに似ていますね。

---

この Statue 2 は基本的に元となった Statue マテリアルの設定を継承します。

なので、Statue の方の色を変更すれば、バリアントの方の色も自動的に変わるわけですね。

---

もうひとつ Statue 3 という名前のマテリアルを作って、今度は右側の石像に設定しました。

この状態で Statue マテリアルの色を変更すると、３つのマテリアルが同時に変化します。

こんな感じで、マテリアル・バリアントを使うことで、複数のマテリアルに共通した設定を持たせたり、特定のマテリアルを元に少しだけ異なるバリエーションを作ったり、といったような事が簡単にできるようになります。

---

このマテリアル・バリアントの仕組み、先ほどのような PBR でも便利なんですが、このようなノンフォト系の絵作りでも便利だと思います。

例えばこのシーンでは簡単なセルシェーダーを使って見た目を作っているんですが、マテリアルの中で影の色などを明示的に設定してあげる必要があります。

こういう共通設定をマテリアル毎に行っていたら面倒臭いですよね。

---

こういった場合は共通設定を扱うためのベースのマテリアルを用意して、各キャラクターはこれを継承したバリアントにすれば……

こんな感じで、影の色などを一発で調整できるようになりました。

---

> Back to Camera

マテリアル・バリアントの基本コンセプトについて説明してきましたが、これの設定方法についてもう少し掘り下げてみましょう。

---

> Switch to Desktop

マテリアル・バリアントの UI はプレハブと似たような感じになっているので、プレハブを使っている人ならすぐに使いこなせると思います。

この右上のメニューから、このバリアントの親となるマテリアルを調べたり、このバリアントでオーバーライドしているプロパティの数など調べられます。

逆に親の方から見ると、こんな感じで、どういうバリアントが存在するか調べることができます。

---

オーバーライドしたプロパティは、こんな感じで強調表示されていて、右クリックメニューから変更を取り消す事もできます。

あと、このオーバーライド設定を親のマテリアルに適用する、なんてこともできますね。

---

また、親のマテリアルでは、プロパティをロックしてオーバーライドを禁止することもできます。

右クリックメニューから "Lock in children" を選ぶと……ロックされましたね。

バリアント側で見てみると、ロックされていて変更できません。

バリアント側で変更されたくないプロパティは、こんな感じでロックしちゃいましょう。

---

あと１点、マテリアル・バリアントの登場によってシェーダーグラフのワークフローがちょっと便利になる、という話もしておきたいと思います。

Unity 2022.1 以降では、シェーダーグラフを作成すると、こんな感じでシェーダーグラフの中にデフォルトマテリアルが用意されます。

このデフォルトマテリアルは、シェーダーグラフ上でのデフォルト値が常に反映されたマテリアルとなっています。

---

以前の感覚で言うと、このシェーダーを使うときは、まずマテリアルを作って、このシェーダーを選択して……という流れで作業していたと思います。

これが今後は、このデフォルトマテリアルを継承したマテリアルバリアントを作って設定していく、という流れが基本になります。

こうすることにより、シェーダーグラフ上でのデフォルト値の変更を、リアルタイムにゲームビュー上で確認できるようになるんですよね。

これのおかげで、シェーダーグラフ上でルックを作るのが楽になると思います。

---

> Back to Camera

こんな感じで今回は Unity のマテリアルバリアントについて紹介してきましたが、いかがでしたでしょうか。

沢山のマテリアルの管理や、複数人での調整作業が楽になる便利な機能だと思います。

ぜひ活用していってください。

---

また今回の動画が参考になったという方は高評価やコメントを頂けますと有難いです。

それではまた次回の動画でお会いしましょう。

</textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create({
        ratio: '16:9',
        highlightStyle: 'sunburst',
        slideNumberFormat: ''
      });
    </script>
  </body>
</html>
