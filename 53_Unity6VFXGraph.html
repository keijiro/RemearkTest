<!DOCTYPE html>
<html lang="ja">
  <head>
    <title>53 Unity 6 VFX Graph</title>
    <meta charset="utf-8">
    <style>
      .remark-slide-content {
        color: white;
        background-color: black;
        font-size: 50pt;
        padding: 0px 0.5em;
      }
      .remark-code-line { font-size: 25pt; margin: 0.2em 0px; }
      p { margin: 0.5em 0px; line-height: 120%; }
      code { margin: 0px 2em; }
    </style>
  </head>
  <body>
<textarea id="source">

> Camera

まず最初は分かりやすく強力な新機能から紹介しましょう。

---

> Browser Demo

Unity 6 では、Web Player において VFX Graph が使えるようになります。

つまり、Web ブラウザ上で動く Unity コンテンツの中で、VFX Graph を使うことができるというわけです。

---

> B-Roll: Discussions

これは Unity 6 において追加された WebGPU サポートと関係しています。

---

WebGPU に対応したことで、Computer Shader などの高度なグラフィックス機能がブラウザ上でも使えるようになりました。

その一環として、VFX Graph も使えるようになったというわけです。

---

> Browser Demo

これは個人的にもすごく驚いたんですが、本当に Web ブラウザ上で、デスクトップアプリと遜色無いグラフィックスを実現することができます。

---

派手なエフェクトや、複雑なビジュアライゼーションなど、様々な可能性がここから広がりそうです。

---

> Mobile Browser Demo

また、モバイルブラウザに対応しているのも面白い点です。

もちろん、いくつかの動作条件を満たす必要はあります。

---

それでも、複雑な VFX がそのままモバイルブラウザで動いてしまうというのは衝撃的です。

---

> WebGPU Demo

Unity の WebGPU サポートについては、また別の機会に詳しく触れたいと思います。

---

参考資料を概要欄に載せておきますので、気になる方は先にそちらをチェックしてみてください。

---

> Camera

次の大きな新機能としては、カスタム HLSL コードへの対応があります。

---

> Custom HLSL Demo

カスタム HLSL コードとは、VFX Graph 内にシェーダーコードの組み込みを可能にする機能です。

---

ノードグラフでは記述の難しい複雑な処理などを、シェーダーコードを使ってコンパクトに実装することができます。

---

> Camera

個人的には、このカスタム HLSL コードには２つの使い道があると思います。

１つ目は、複雑な数式の記述を簡略化するというものです。

---

> Figures

例えば、こんな計算を VFX Graph 内で行うとしましょう。

ヒマワリの花のような配置パターンですね。

---

これをノードグラフで実装すると、このようになります。

そこまで複雑ではないですが、どうしても間伸びしたものになってしまいますね。

---

これをシェーダーコードで実装すると、このようになります。

どちらの方が分かりやすいかは、人それぞれかもしれません。

---

でも、こちらのコードの方がコンパクトで良い、という人は、それなりにいると思います。

そういう場合には、こちらのカスタムコードを使う、という選択ができるようになったわけです。

---

> Camera

２つ目の使い道は、そもそも VFX Graph では不可能だった機能をカスタム実装する、というものです。

---

> Shader Code

VFX Graph で不可能だった処理の代表的なものとして、Graphics Buffer への書き込みがあります。

読み込みはできたんですけど、書き込みの機能は無かったんですよね。

これがカスタムコードの中であれば、簡単にできます。

---

> Custom HLSL Sample

このサンプルでは、カスタムコードの中で Graphics Buffer を更新することで、近接パーティクルの検索を可能にしています。

---

通常の VFX Graph では、他のパーティクルを参照する機能が無いので、こういうエフェクトを作るのはなかなか難しかったんですよね。

---

このように、カスタム HLSL コードは、VFX Graph の表現力を更に向上させる新機能になっていると思います。

---

> Camera

次の大きな新機能は、プロファイリングツールの拡充です。

---

> Editor

これは VFX の処理負荷やメモリ使用量、稼働中のパーティクル数などをリアルタイムに監視する機能です。

VFX の最適化を行うにあたって重要な機能になります。

---

個人的には、稼働中のパーティクル数を簡単に調べられるようになったのが嬉しいですね。

これで各パーティクルシステムの capacity を適切に調整できるようになりました。

---

> Camera

Unity 6 の VFX Graph では、この他にも、Editor の細かな UI/UX の改善が行われています。

---

今までと操作方法が若干変わっている部分もあるので、それらの点を中心にちょっと紹介してみます。

---

> Editor

まず大きく変わったのは、カスタムアトリビュートの扱いです。

今までは Set Custom ブロックと、Get Custom オペレーターが提供されていました。

ただ、アトリビュート名を手動で管理する必要があるなど、若干の使いにくさがあったと思います。

---

Unity 6 では、プロパティを管理する Blackboard の中で、アトリビュートも管理できるようになりました。

例えば、このパーティクルシステムに “UV” という名前のカスタムアトリビュートを追加しましょう。

---

各パーティクルの UV アトリビュートを set するには、これを Blackboard からコンテキストにドラック・アンド・ドロップします。

---

そして、各パーティクルの UV アトリビュートを get するには、これを Blackboard から空白部分にドラック・アンド・ドロップします。

だいぶ簡単な操作になりましたね。

---

もう一点、大きく変わっているのは、ノードサーチ機能の改善です。

VFX Graph には無数のオペレーターやブロックが存在していて、それらすべてを候補として表示するのは、ちょっと無理がありました。

---

そのため、新しいノードサーチでは、代表的なものだけを最初に表示するようになりました。

そのうえで、このサブメニューボタンを押すと、その派生ノードを候補として表示できます。

---

あるいは、このトグルをオンにしておくことで、最初からすべての派生ノードを検索対象にすることもできます。

---

これに関連した小さな変更として、”inherit” という用語の廃止があります。

以前のバージョンの VFX Graph では、親のシステムからアトリビュートを引き継ぐことを “inherit” と呼んでいました。

---

これが Unity 6 からは “From Source” という modifier によって置き換えられています。

---

例えば、以前のバージョンでは “Inherit Position” などとしていたものは、”Set Position From Source” になります。

“Inherit” で検索しても何も表示されないので気をつけてください。

---



</textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create({
        ratio: '16:9',
        highlightStyle: 'sunburst',
        slideNumberFormat: ''
      });
    </script>
  </body>
</html>
